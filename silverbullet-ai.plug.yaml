name: silverbullet-ai
requiredPermissions:
  - fetch
assets:
  - "assets/*"
functions:
  queryAI:
    path: sbai.ts:queryAI
  chat:
    path: sbai.ts:chat

  promptAndGenerateImage:
    path: sbai.ts:promptAndGenerateImage
    command:
      name: "AI: Generate and insert image using DallE"
  streamChatOnPage:
    path: sbai.ts:streamChatOnPage
    command:
      name: "AI: Chat on current page"
      key: "Ctrl-Shift-Enter"
      mac: "Cmd-Shift-Enter"
  insertAiPromptFromTemplate:
    path: src/prompts.ts:insertAiPromptFromTemplate
    command:
      name: "AI: Execute AI Prompt from Custom Template"
  selectTextModel:
    path: sbai.ts:selectModelFromConfig
    command:
      name: "AI: Select Text Model from Config"
  selectImageModel:
    path: sbai.ts:selectImageModelFromConfig
    command:
      name: "AI: Select Image Model from Config"
  selectEmbeddingModel:
    path: sbai.ts:selectEmbeddingModelFromConfig
    command:
      name: "AI: Select Embedding Model from Config"
  refreshModelList:
    path: src/model-discovery.ts:refreshModelListCommand
    command:
      name: "AI: Refresh Model List"
  selectAgent:
    path: sbai.ts:selectAgentCommand
    command:
      name: "AI: Select Agent"
  clearAgent:
    path: sbai.ts:clearAgentCommand
    command:
      name: "AI: Clear Agent"
  testEmbeddingGeneration:
    path: sbai.ts:testEmbeddingGeneration
    command:
      name: "AI: Test Embedding Generation"
  getAllEmbeddings:
    path: src/embeddings.ts:getAllEmbeddings
  searchEmbeddings:
    path: src/embeddings.ts:searchEmbeddings
  queueEmbeddingGeneration:
    path: src/embeddings.ts:queueEmbeddingGeneration
    events:
      - page:index
  processEmbeddingsQueue:
    path: src/embeddings.ts:processEmbeddingsQueue
    mqSubscriptions:
      - queue: aiEmbeddingsQueue
        batchSize: 1
        autoAck: true
        pollInterval: 600000
  processSummaryQueue:
    path: src/embeddings.ts:processSummaryQueue
    mqSubscriptions:
      - queue: aiSummaryQueue
        batchSize: 1
        autoAck: true
        pollInterval: 600000
  generateEmbeddings:
    path: src/embeddings.ts:generateEmbeddings
  searchEmbeddingsForChat:
    path: src/embeddings.ts:searchEmbeddingsForChat
  searchCombinedEmbeddings:
    path: src/embeddings.ts:searchCombinedEmbeddings
  searchSummaryEmbeddings:
    path: src/embeddings.ts:searchSummaryEmbeddings
  getSearchResults:
    path: src/embeddings.ts:getSearchResults
  searchCommand:
    path: src/embeddings.ts:searchCommand
    command:
      name: "AI: Search"
  reindexAllEmbeddings:
    path: src/embeddings.ts:reindexAllEmbeddings
    command:
      name: "AI: Reindex All Embeddings"
  getConnectivityTestResults:
    path: src/connectivity.ts:getConnectivityTestResults
  connectivityTestCommand:
    path: src/connectivity.ts:connectivityTestCommand
    command:
      name: "AI: Connectivity Test"
  getBenchmarkResults:
    path: src/benchmark.ts:getBenchmarkResults
  benchmarkCommand:
    path: src/benchmark.ts:benchmarkCommand
    command:
      name: "AI: Run Benchmark"

  # AI Assistant Panel
  openAIAssistant:
    path: src/chat-panel.ts:openAIAssistant
    command:
      name: "AI: Open Assistant"
  openAIAssistantModal:
    path: src/chat-panel.ts:openAIAssistantModal
    command:
      name: "AI: Open Assistant (Full Screen)"
  closeAIAssistant:
    path: src/chat-panel.ts:closeAIAssistant
  toggleAIAssistant:
    path: src/chat-panel.ts:toggleAIAssistant
    command:
      name: "AI: Toggle Assistant Panel"
      key: "Ctrl-Shift-a"
      mac: "Cmd-Shift-a"
  startPanelChat:
    path: src/chat-panel.ts:startPanelChat
  getPanelChatChunk:
    path: src/chat-panel.ts:getPanelChatChunk
  chatAgentState:
    path: src/chat-panel.ts:chatAgentState
  exportPanelChat:
    path: src/chat-panel.ts:exportPanelChat
  getChatStatus:
    path: src/chat-panel.ts:getChatStatus
  resetSessionTokenUsage:
    path: src/chat-panel.ts:resetSessionTokenUsage
  submitApproval:
    path: src/tools.ts:submitApproval
  requestWriteApproval:
    path: src/tools.ts:requestWriteApproval
  getWriteDiff:
    path: src/tools.ts:getWriteDiff
  postProcessToolCallHtml:
    path: src/utils.ts:postProcessToolCallHtml
  renderToolCallWidget:
    path: sbai.ts:renderToolCallWidget
    codeWidget: toolcall
